Description: finish null pointer checks
 Apply contributed patches to layout engine.
Author: Laszlo Boszormenyi (GCS) <gcs@debian.org>
Origin: upstream, https://ssl.icu-project.org/trac/changeset/37086
Reviewed-By: srl, bae, mschoene
Forwarded: not-needed
Last-Update: 2015-07-25

---

--- icu-4.8.1.1.orig/source/layout/ContextualSubstSubtables.cpp
+++ icu-4.8.1.1/source/layout/ContextualSubstSubtables.cpp
@@ -1,5 +1,5 @@
 /*
- * (C) Copyright IBM Corp. 1998-2013 - All Rights Reserved
+ * (C) Copyright IBM Corp. 1998-2015 - All Rights Reserved
  *
  */
 
@@ -466,6 +466,12 @@ le_uint32 ChainingContextualSubstitution
                 const ChainSubClassRuleTable *chainSubClassRuleTable =
                     (const ChainSubClassRuleTable *) ((char *) chainSubClassSetTable + chainSubClassRuleTableOffset);
                 le_uint16 backtrackGlyphCount = SWAPW(chainSubClassRuleTable->backtrackGlyphCount);
+
+                // TODO: Ticket #11557 - enable this check, originally from ticket #11525.
+                //       Depends on other, more extensive, changes.
+                // LEReferenceToArrayOf<le_uint16>   backtrackClassArray(base, success, chainSubClassRuleTable->backtrackClassArray, backtrackGlyphCount);
+                if( LE_FAILURE(success) ) { return 0; }
+
                 le_uint16 inputGlyphCount = SWAPW(chainSubClassRuleTable->backtrackClassArray[backtrackGlyphCount]) - 1;
                 const le_uint16 *inputClassArray = &chainSubClassRuleTable->backtrackClassArray[backtrackGlyphCount + 1];
                 le_uint16 lookaheadGlyphCount = SWAPW(inputClassArray[inputGlyphCount]);
--- icu-4.8.1.1.orig/source/layout/CursiveAttachmentSubtables.cpp
+++ icu-4.8.1.1/source/layout/CursiveAttachmentSubtables.cpp
@@ -1,5 +1,5 @@
 /*
- * (C) Copyright IBM Corp. 1998 - 2013 - All Rights Reserved
+ * (C) Copyright IBM Corp. 1998 - 2015 - All Rights Reserved
  *
  */
 
--- icu-4.8.1.1.orig/source/layout/LETableReference.h
+++ icu-4.8.1.1/source/layout/LETableReference.h
@@ -1,7 +1,7 @@
 /*
  * -*- c++ -*-
  *
- * (C) Copyright IBM Corp. and others 2013 - All Rights Reserved
+ * (C) Copyright IBM Corp. and others 2015 - All Rights Reserved
  *
  * Range checking
  *
--- icu-4.8.1.1.orig/source/layout/MultipleSubstSubtables.cpp
+++ icu-4.8.1.1/source/layout/MultipleSubstSubtables.cpp
@@ -1,6 +1,6 @@
 /*
  *
- * (C) Copyright IBM Corp. 1998-2013 - All Rights Reserved
+ * (C) Copyright IBM Corp. 1998-2015 - All Rights Reserved
  *
  */
 
